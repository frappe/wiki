{% from "templates/wiki/macros/sidebar_tree.html" import render_wiki_tree %}

<div class="wiki-sidebar w-72 bg-gray-50 border-r border-gray-200 h-screen overflow-y-auto" 
     x-data="wikiSidebar()">
    <div class="p-4 border-b border-gray-200 bg-white">
        <div>
            <img class="size-8" src="{{ wiki_space.light_mode_logo }}"/>
            <h3 class="text-lg font-semibold text-gray-700">{{ wiki_space.space_name or _("Wiki") }}</h3>
        </div>
    </div>
    <nav class="py-2">
        {{ render_wiki_tree(nested_tree) }}
    </nav>
</div>

<script>
    function wikiSidebar() {
        return {
            // Store expanded states with persistence
            expandedStates: Alpine.$persist({}),
            
            init() {
                // Initialize any setup if needed
                console.log('Wiki sidebar initialized with Alpine.js');
            },
            
            toggleNode(nodeId) {
                // Toggle the expanded state for this node
                this.expandedStates[nodeId] = !this.expandedStates[nodeId];
            },
            
            isExpanded(nodeId) {
                // Return whether this node is expanded (default to false)
                return this.expandedStates[nodeId] || false;
            }
        }
    }
</script>
